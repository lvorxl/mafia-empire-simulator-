<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Mafia Empire Game</title>
    <style>
        body { margin: 0; }
        canvas { display: block; }
        #game-container { position: relative; }
        #game-ui { position: absolute; top: 10px; left: 10px; color: white; }
        .button { padding: 10px 20px; background-color: #333; color: white; border: none; margin: 5px; cursor: pointer; }
    </style>
</head>
<body>
    <div id="game-container">
        <div id="game-ui">
            <p id="money-display">Money: $0</p>
            <p id="reputation">Reputation: 50</p>
            <p id="empire-level">Empire Level: 1</p>
            <button class="button" onclick="expandTerritory()">Expand Territory</button>
            <button class="button" onclick="showRecruitmentScreen()">Recruit</button>
            <button class="button" onclick="showMapScreen()">Map</button>
        </div>
        <canvas id="game-canvas"></canvas>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        let money = 0;
        let reputation = 50;
        let empireLevel = 1;
        let passiveIncome = 500;
        let gangMembers = [];
        let territories = [];
        let rivalGangs = generateRivalGangs(10);

        // 3D Setup
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ canvas: document.getElementById("game-canvas") });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        // Lighting
        const light = new THREE.AmbientLight(0x404040, 2);  // Ambient light
        scene.add(light);

        // Create a simple 3D object (like a cube) to represent part of the world
        const geometry = new THREE.BoxGeometry(1, 1, 1);
        const material = new THREE.MeshBasicMaterial({ color: 0x00ff00 });
        const cube = new THREE.Mesh(geometry, material);
        scene.add(cube);

        camera.position.z = 5;

        // Animation loop
        function animate() {
            requestAnimationFrame(animate);

            // Rotate the cube
            cube.rotation.x += 0.01;
            cube.rotation.y += 0.01;

            renderer.render(scene, camera);
        }

        animate();

        // Game Logic

        function expandTerritory() {
            if (money >= 5000) {
                money -= 5000;
                territories.push({ name: `New Territory ${territories.length + 1}` });
                updateGameUI();
                alert("Territory expanded!");
            } else {
                alert("Not enough money!");
            }
        }

        function showRecruitmentScreen() {
            const recruitUI = `
                <h3>Recruit New Gang Members</h3>
                <button class="button" onclick="recruitGangMember()">Recruit ($5000)</button>
            `;
            document.getElementById("game-ui").innerHTML = recruitUI;
        }

        function recruitGangMember() {
            if (money >= 5000) {
                money -= 5000;
                gangMembers.push({ name: `Gang Member ${gangMembers.length + 1}`, strength: Math.floor(Math.random() * 100) + 50 });
                updateGameUI();
                alert("New gang member recruited!");
            } else {
                alert("Not enough money!");
            }
        }

        function updateGameUI() {
            document.getElementById("money-display").textContent = `Money: $${money}`;
            document.getElementById("reputation").textContent = `Reputation: ${reputation}`;
            document.getElementById("empire-level").textContent = `Empire Level: ${empireLevel}`;
        }

        function generateRivalGangs(count) {
            const gangNames = ["Iron Fangs", "Blood Wolves", "Shadow Serpents", "Crimson Daggers"];
            const gangs = [];
            for (let i = 0; i < count; i++) {
                gangs.push({
                    name: gangNames[Math.floor(Math.random() * gangNames.length)] + ` #${i + 1}`,
                    strength: Math.floor(Math.random() * 100) + 50,
                    territories: Math.floor(Math.random() * 5) + 1,
                });
            }
            return gangs;
        }

        function showMapScreen() {
            const mapUI = `
                <h3>Territory Map</h3>
                <p>Your Territories: ${territories.length}</p>
                <button class="button" onclick="attackRival()">Attack Rival Gang</button>
            `;
            document.getElementById("game-ui").innerHTML = mapUI;
        }

        function attackRival() {
            if (gangMembers.length === 0) {
                alert("You need gang members to attack!");
                return;
            }

            const targetGang = rivalGangs[Math.floor(Math.random() * rivalGangs.length)];
            const yourStrength = gangMembers.reduce((sum, member) => sum + member.strength, 0);
            const outcome = yourStrength > targetGang.strength;

            if (outcome) {
                targetGang.territories--;
                territories.push({ name: `Captured from ${targetGang.name}` });
                reputation += 10;
                alert(`You defeated ${targetGang.name} and claimed their territory!`);
            } else {
                reputation -= 10;
                alert(`You lost the battle against ${targetGang.name}.`);
            }
            updateGameUI();
        }
    </script>
</body>
</html>